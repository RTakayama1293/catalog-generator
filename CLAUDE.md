# 商品カタログ生成システム

## プロジェクト概要

商品マスタ（Excel）と画像から、仕入先別の商品カタログ（PowerPoint/PDF）を自動生成するシステム。

## ディレクトリ構成

```
catalog-generator/
├── CLAUDE.md                      # このファイル
├── README.md                      # 使い方説明
├── generate_catalog.py            # メイン生成スクリプト
├── requirements.txt
├── templates/
│   └── catalog_template.pptx      # カタログテンプレート
├── data/
│   └── 受発注管理台帳.xlsx         # 商品マスタ（ここに配置）
├── images/
│   └── {商品連番}.jpg              # 商品画像
└── output/                        # 生成されたカタログ
```

## 主要タスク

### カタログ生成

```bash
python generate_catalog.py {仕入先コード} \
  --excel data/受発注管理台帳.xlsx \
  --template templates/catalog_template.pptx \
  --images images \
  --output output
```

例: `python generate_catalog.py HAK`

### PDF変換

```bash
libreoffice --headless --convert-to pdf --outdir output output/カタログ_*.pptx
```

## データ仕様

### 商品マスタ（Excel）

シート「商品マスタ」、ヘッダー行=2行目

| 列名 | 用途 |
|------|------|
| 商品連番 | 商品ID（例: PRD_SNJ_HAK_0001_01） |
| 商品名 | 商品名 |
| 仕入先 | 仕入先名 |
| 容量 | 容量 |
| 単位 | 販売単位 |
| 発注ロット | MOQ |
| 温度帯 | 常温/冷蔵/冷凍 |
| 賞味期限 | 賞味期限 |
| 国内定価（15％） | 販売価格 |
| 参考上代（税込) | メーカー希望小売価格 |
| 商品特徴 | 商品説明文 |

### 仕入先コード

商品連番 `PRD_SNJ_{仕入先コード}_{連番}_{版}` から抽出。

主要コード:
- GGM: GOODGOOD (97商品)
- HAK: 北見ハッカ通商 (16商品)
- FJT: フジタコーポレーション (37商品)

### 画像ファイル

配置: `images/{商品連番}.jpg`（jpg, png, webp対応）

例: `images/PRD_SNJ_HAK_0001_01.jpg`

## テンプレート編集

`templates/catalog_template.pptx` をPowerPointで編集可能。

### プレースホルダー一覧

| プレースホルダー | 内容 |
|-----------------|------|
| `{{仕入先名}}` | 仕入先名 |
| `{{商品名_1}}`, `{{商品名_2}}` | 商品名 |
| `{{容量_1}}`, `{{容量_2}}` | 容量 |
| `{{単位_1}}`, `{{単位_2}}` | 単位 |
| `{{MOQ_1}}`, `{{MOQ_2}}` | 発注ロット |
| `{{温度帯_1}}`, `{{温度帯_2}}` | 温度帯 |
| `{{賞味期限_1}}`, `{{賞味期限_2}}` | 賞味期限 |
| `{{価格_1}}`, `{{価格_2}}` | 国内定価 |
| `{{参考上代_1}}`, `{{参考上代_2}}` | 参考上代 |
| `{{商品説明_1}}`, `{{商品説明_2}}` | 商品特徴 |
| `{{画像_1}}`, `{{画像_2}}` | 商品画像 |

## 注意事項

- テンプレート編集後もプレースホルダーの `{{...}}` 形式を維持すること
- 画像がない商品はプレースホルダーのまま出力される
- 1ページ2商品（上下配置）
